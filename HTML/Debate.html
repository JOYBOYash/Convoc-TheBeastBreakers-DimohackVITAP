<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debate</title>
    <link rel="stylesheet" href="/CSS/settings.css">
    <script src="https://cdn.jsdelivr.net/npm/web3@1.3.0/dist/web3.min.js"></script>
    <script type="text/javascript">
        var web3 = new Web3(Web3.givenProvider || "http://localhost:8545"); // Connect to local or injected web3 provider
        var contractAddress = 'YOUR_CONTRACT_ADDRESS'; // Replace with your deployed contract address
        var contractABI = [
            // Replace with your contract ABI
        ];
        var contract = new web3.eth.Contract(contractABI, contractAddress);

        function addMessage() {
            var content = document.getElementById("messageInput").value;
            contract.methods.addMessage(content).send({from: web3.eth.defaultAccount})
            .on('receipt', function(receipt){
                console.log("Message added:", receipt);
                displayMessages();
            });
        }

        function displayMessages() {
            contract.methods.messageCount().call().then(function(count) {
                for (var i = 0; i < count; i++) {
                    contract.methods.getMessage(i).call().then(function(result) {
                        var messageElement = document.createElement("div");
                        messageElement.innerHTML = result[0] + ": " + result[1];
                        document.getElementById("messages").appendChild(messageElement);
                    });
                }
            });
        }

        window.onload = function() {
            displayMessages();
        };
    </script>
</head>
<body>
    <div class="main">
        <div class="lgo">
            <h1 class="head">Elbater</h1>
        </div>
        <div class="box">
            <form>
                <label>Create Debate</label>
                <input type="file" id="img" name="img" placeholder="Add Img" accept="image/*">
                <input type="text" id="opinionInp" name="opinion" placeholder="Share your opinion">
                <button type="submit" onclick="addMessage()">Publish <b>&#8594;</b></button>
                <div class="message" id="messages"></div>

                <h2 class="head hi" onclick="redirect()"> Debate </h2>
                <div id="forums"></div>


                
          <a class="new" href="/HTML/homePage.html"><b>Home &#x2190;</b></a>
            </form>
        </div>
    </div>
    <script type="module" src="#">



                   const firebaseConfig = {
                    apiKey: "AIzaSyBgd5TasgU1o1GFud1Nv98wiDTzNMzepnw",
                    authDomain: "lingua-link-2907a.firebaseapp.com",
                  databaseURL: "https://lingua-link-2907a-default-rtdb.asia-southeast1.firebasedatabase.app",
                  projectId: "lingua-link-2907a",
                  storageBucket: "lingua-link-2907a.appspot.com",
                  messagingSenderId: "451405127324",
                    appId: "1:451405127324:web:71d41d5791af4c6a68d759"
};


        function redirect(){

        }
         function createForum() {
            var forumName = document.getElementById("forumNameInput").value;
            contract.methods.createForum(forumName).send({from: web3.eth.defaultAccount})
            .on('receipt', function(receipt){
                console.log("Forum created:", receipt);
                // Refresh forums list
                displayForums();
            });
        }
    </script>
</body>
</html>

<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debate</title>
    <link rel="stylesheet" href="/CSS/settings.css">
    <script src="https://cdn.jsdelivr.net/npm/web3@1.3.0/dist/web3.min.js"></script>
    <script type="text/javascript">
        var web3 = new Web3(Web3.givenProvider || "http://localhost:8545"); // Connect to local or injected web3 provider
        var contractAddress = 'YOUR_CONTRACT_ADDRESS'; // Replace with your deployed contract address
        var contractABI = [
            // Replace with your contract ABI
        ];
        var contract = new web3.eth.Contract(contractABI, contractAddress);

        // Function to create a new forum
        function createForum() {
            var forumName = document.getElementById("forumNameInput").value;
            contract.methods.createForum(forumName).send({from: web3.eth.defaultAccount})
            .on('receipt', function(receipt){
                console.log("Forum created:", receipt);
                // Add code to update UI with the newly created forum
            });
        }

        // Function to add message to a forum
        function addMessage(forumIndex) {
            var content = document.getElementById("messageInput").value;
            var username = getCurrentUsername(); // Function to get current user's username from Firebase
            contract.methods.addMessage(forumIndex, content).send({from: web3.eth.defaultAccount})
            .on('receipt', function(receipt){
                console.log("Message added:", receipt);
                // Add code to update UI with the newly added message
            });
        }

        // Function to retrieve messages for a forum
        function displayMessages(forumIndex) {
            contract.methods.forums(forumIndex).call().then(function(forum) {
                for (var i = 0; i < forum.messageCount; i++) {
                    contract.methods.getMessage(forumIndex, i).call().then(function(result) {
                        var messageElement = document.createElement("div");
                        messageElement.innerHTML = "<strong>" + result[0] + ":</strong> " + result[1];
                        document.getElementById("forum_" + forumIndex + "_messages").appendChild(messageElement);
                    });
                }
            });
        }

        function getCurrentUsername() {
            // Function to fetch current user's username from Firebase database
            // You need to implement this function according to your Firebase database structure
        }

        window.onload = function() {
            // Add code to fetch existing forums and update UI accordingly
        };
    </script>
</head>
<body>
    <h1>Discussion Forums</h1>
    <h2>Create New Forum</h2>
    <input type="text" id="forumNameInput" placeholder="Forum Name">
    <button onclick="createForum()">Create</button>

Add UI elements to display existing forums and allow users to select a forum -->

    <!-- Forum messages section -->
    <!-- <div id="forum_0_messages"></div> Use dynamic IDs for each forum -->
    <!-- <input type="text" id="messageInput" placeholder="Type your message...">
    <button onclick="addMessage(0)">Post</button> Pass forum index as argument --> -->

    <!-- Add more similar sections for other forums -->
<!-- </body>
</html> --> 

<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debates </title>
    <link rel="stylesheet" href="/CSS/settings.css">
    <script src="https://cdn.jsdelivr.net/npm/web3@1.3.0/dist/web3.min.js"></script>
    <script type="text/javascript">
        var web3 = new Web3(Web3.givenProvider || "http://localhost:8545"); // Connect to local or injected web3 provider
        var contractAddress = 'YOUR_CONTRACT_ADDRESS'; // Replace with your deployed contract address
        var contractABI = [
            // Replace with your contract ABI
        ];
        var contract = new web3.eth.Contract(contractABI, contractAddress);

        // Function to create a new forum
        function createForum() {
            var forumName = document.getElementById("forumNameInput").value;
            contract.methods.createForum(forumName).send({from: web3.eth.defaultAccount})
            .on('receipt', function(receipt){
                console.log("Forum created:", receipt);
                // Refresh forums list
                displayForums();
            });
        }

        // Function to add message to a forum
        function addMessage(forumIndex) {
            var content = document.getElementById("messageInput_" + forumIndex).value;
            var username = getCurrentUsername(); // Function to get current user's username from Firebase
            contract.methods.addMessage(forumIndex, content).send({from: web3.eth.defaultAccount})
            .on('receipt', function(receipt){
                console.log("Message added:", receipt);
                // Refresh messages for this forum
                displayMessages(forumIndex);
            });
        }

        // Function to retrieve messages for a forum
        function displayMessages(forumIndex) {
            contract.methods.forums(forumIndex).call().then(function(forum) {
                var messagesDiv = document.getElementById("forum_" + forumIndex + "_messages");
                messagesDiv.innerHTML = ""; // Clear previous messages
                for (var i = 0; i < forum.messageCount; i++) {
                    contract.methods.getMessage(forumIndex, i).call().then(function(result) {
                        var messageElement = document.createElement("div");
                        messageElement.innerHTML = "<strong>" + result[0] + ":</strong> " + result[1];
                        messagesDiv.appendChild(messageElement);
                    });
                }
            });
        }

        // Function to display forums
        function displayForums() {
            contract.methods.forumCount().call().then(function(count) {
                var forumsDiv = document.getElementById("forums");
                forumsDiv.innerHTML = ""; // Clear previous forums
                for (var i = 0; i < count; i++) {
                    contract.methods.forums(i).call().then(function(forum) {
                        var forumElement = document.createElement("div");
                        forumElement.innerHTML = "<h3>" + forum.name + "</h3>" +
                                                  "<div id='forum_" + forum.index + "_messages'></div>" +
                                                  "<input type='text' id='messageInput_" + forum.index + "' placeholder='Type your message...'>" +
                                                  "<button onclick='addMessage(" + forum.index + ")'>Post</button>";
                        forumsDiv.appendChild(forumElement);
                        displayMessages(forum.index); // Display messages for this forum
                    });
                }
            });
        }

        function getCurrentUsername() {
            // Function to fetch current user's username from Firebase database
            // You need to implement this function according to your Firebase database structure
        }

        window.onload = function() {
            displayForums();
        };
    </script>
</head>
<body>
   <div class="box">
          <h1>Discussion Forums</h1>
    
         Create Forum Section 
        <h2>Create New Forum</h2>
        <input type="text" id="forumNameInput" placeholder="Forum Name">
        <button onclick="createForum()">Publish <b>&#8594;</b></button>
   </div>

    <h2>Forums</h2>
    <div id="forums"></div>
</body>
</html> -->
